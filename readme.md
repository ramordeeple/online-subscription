# üè∑Ô∏è **Online Subscription Service**

### –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏.

* **–°–æ–∑–¥–∞–Ω–∏–µ / –ø—Ä–æ—Å–º–æ—Ç—Ä / –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ / —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ (CRUDL)**
* **–ü–æ–¥—Å—á–µ—Ç —Å—É–º–º–∞—Ä–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –∑–∞ –ø–µ—Ä–∏–æ–¥**
* **Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
* **–õ–æ–≥–∏ —á–µ—Ä–µ–∑ Uber Zap**
* **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ PostgreSQL**

---

## ‚öôÔ∏è **–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                                                                      |
|-----------------|---------------------------------------------------------------------------------|
| Backend         | Go 1.25+, [Zap](https://github.com/uber-go/zap), [UUID](github.com/google/uuid) |
| Database        | PostgreSQL                                                                      |
| Migrations      | SQL —Ñ–∞–π–ª—ã + –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π runner                                                   |
| API Docs        | [Swaggo](https://github.com/swaggo/swag)                                        |
| Dev Environment | Docker Compose                                                                  |

---

## üóÇÔ∏è **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
online-subscription/
‚îú‚îÄ cmd/
‚îÇ  ‚îî‚îÄ online-subscription/
‚îÇ     ‚îî‚îÄ main.go                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ docs/                          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ Swagger UI
‚îú‚îÄ internal/
‚îÇ  ‚îú‚îÄ app/
‚îÇ  ‚îÇ  ‚îú‚îÄ app.go                   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îÇ  ‚îÇ  ‚îî‚îÄ router.go                # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ HTTP –º–∞—Ä—à—Ä—É—Ç–æ–≤
‚îÇ  ‚îú‚îÄ config/
‚îÇ  ‚îÇ  ‚îî‚îÄ config.go                # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ YAML/.env
‚îÇ  ‚îú‚îÄ handler/
‚îÇ  ‚îÇ  ‚îú‚îÄ subscription_handler.go  # –û—Å–Ω–æ–≤–Ω–æ–π CRUDL —Ö—ç–Ω–¥–ª–µ—Ä –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
‚îÇ  ‚îÇ  ‚îú‚îÄ dto/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ request.go            # DTO –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ API
‚îÇ  ‚îÇ  ‚îú‚îÄ helpers/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ helpers.go            # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (JSON, ptr/safe)
‚îÇ  ‚îÇ  ‚îú‚îÄ mapper/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ subscription_mapper.go # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
‚îÇ  ‚îÇ  ‚îú‚îÄ parser/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ subscription_parser.go # –†–∞–∑–±–æ—Ä –∏ –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
‚îÇ  ‚îÇ  ‚îî‚îÄ validator/
‚îÇ  ‚îÇ     ‚îî‚îÄ subscription_validator.go # –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ  ‚îú‚îÄ logger/
‚îÇ  ‚îÇ  ‚îî‚îÄ logger.go                # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Zap –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ  ‚îú‚îÄ model/
‚îÇ  ‚îÇ  ‚îî‚îÄ subscription.go          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Subscription)
‚îÇ  ‚îú‚îÄ repository/
‚îÇ  ‚îÇ  ‚îú‚îÄ postgres/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ postgres.go           # PostgreSQL —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ  ‚îÇ  ‚îî‚îÄ migrations.go            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –ë–î
‚îÇ  ‚îî‚îÄ usecase/
‚îÇ     ‚îî‚îÄ subscription.go          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ CRUDL –ø–æ–¥–ø–∏—Å–æ–∫
‚îî‚îÄ migrations/
   ‚îú‚îÄ 000001_initial_schema.up.sql
   ‚îî‚îÄ 000001_initial_schema.down.sql

```

---

## üöÄ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**

### 1Ô∏è‚É£ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

* üê≥ Docker Desktop
* üíª Go 1.25+
* üõ†Ô∏è –õ—é–±–æ–π HTTP –∫–ª–∏–µ–Ω—Ç (**Postman**, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ **GoLand**)

---

### 2Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
docker compose up -d
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ      |
|----------|---------------|
| Host     | db            |
| Port     | 5432          |
| Database | subscriptions |
| Username | subscription  |
| Password | 123           |

---

### 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í —Ñ–∞–π–ª–µ `.env` (–∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ Docker Compose):

```
DB_HOST=db
DB_PORT=5432
DB_USER=subscription
DB_PASSWORD=123
DB_NAME=subscriptions
DB_SSLMODE=disable
APP_PORT=8080
```

---

### 4Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
docker compose build
docker compose up
```

> üí° –õ–∏–±–æ –∂–µ –≤—Å–µ –≤ **Docker Desktop** –º—ã—à–∫–æ–π.

üìç –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8080](http://localhost:8080)

> ‚ö†Ô∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üìò **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

| –¢–∏–ø          | URL                                                                                  |
|--------------|--------------------------------------------------------------------------------------|
| Swagger UI   | [http://localhost:8080/swagger/index.html](http://localhost:8080/swagger/index.html) |
| OpenAPI JSON | [http://localhost:8080/swagger/doc.json](http://localhost:8080/swagger/doc.json)     |

---

## üóÉÔ∏è **–ú–∏–≥—Ä–∞—Ü–∏–∏**

* –ü–∞–ø–∫–∞: `migrations/`
* –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
* –¢–∞–±–ª–∏—Ü–∞ `subscriptions` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üì¶ **–ü—Ä–∏–º–µ—Ä—ã HTTP –∑–∞–ø—Ä–æ—Å–æ–≤**

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

```http
POST http://localhost:8080/subscriptions
Content-Type: application/json

{
  "service_name": "Netflix",
  "price": 999,
  "start_date": "12-2025",
  "user_id": "54639c13-710c-48f1-80b0-d18e88a6e9f5"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å–æ–∫

```http
GET http://localhost:8080/subscriptions
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ ID

```http
GET http://localhost:8080/subscriptions/{id}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

```http
PUT http://localhost:8080/subscriptions/{id}
Content-Type: application/json

{
  "service_name": "Spotify",
  "price": 1200,
  "start_date": "01-2026"
}
```

### –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

```http
DELETE http://localhost:8080/subscriptions/{id}
```

### –°—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–æ–∫

```http
GET http://localhost:8080/subscriptions/summary?from=01-2025&user_id=54639c13-710c-48f1-80b0-d18e88a6e9f5&service_name=Netflix
```

---
üåê **HTTP Client (api-samples.http)**

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API —Å –ø–æ–º–æ—â—å—é –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ `requests/api-samples.http`.

üìÅ –§–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞: `requests/api-samples.http` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤.

üí≥ **–°—Ü–µ–Ω–∞—Ä–∏–∏**

üë®‚Äçüíº **ADMIN**
- –°–æ–∑–¥–∞—ë—Ç –ø–æ–¥–ø–∏—Å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (`POST /subscriptions`)
- –ú–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –ª—é–±—É—é –ø–æ–¥–ø–∏—Å–∫—É (`DELETE /subscriptions/{id}`)
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å–æ–∫ (`GET /subscriptions`)
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—É–º–º–∞—Ä–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–æ–∫ –∑–∞ –ø–µ—Ä–∏–æ–¥ (`GET /subscriptions/summary?from=MM-YYYY&user_id=&service_name=`)

üôã‚Äç‚ôÇÔ∏è **USER**
- –°–æ–∑–¥–∞—ë—Ç –ø–æ–¥–ø–∏—Å–∫—É –¥–ª—è —Å–µ–±—è (`POST /subscriptions`)
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å–≤–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (`GET /subscriptions?user_id=<id>`)
- –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –ø–æ ID (`GET /subscriptions/{id}`)
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—É–º–º–∞—Ä–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–æ–∫ –∑–∞ –ø–µ—Ä–∏–æ–¥ (`GET /subscriptions/summary`)

üí° –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ **user_id** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã (`MM-YYYY`).

> üîë –î–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–∞–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `user_id`, `service_name`, `from` –∏ `to` (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω).  
> üìù `api-samples.http` —Å–æ–¥–µ—Ä–∂–∏—Ç –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É API.

